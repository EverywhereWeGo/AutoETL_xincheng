set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;

INSERT OVERWRITE table {ODS}.{ods_tablename} partition(PT)
SELECT
{fileds}
to_date({dateflag})
FROM {SRC}.{src_tablename}
DISTRIBUTE BY to_date({dateflag});